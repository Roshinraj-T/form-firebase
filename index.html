<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./style.css">
   <!-- Include Firebase App (v7.14.6) -->
<script src="https://www.gstatic.com/firebasejs/7.14.6/firebase-app.js"></script>
<!-- Include Firebase Performance (v7.14.6) -->
<script src="https://www.gstatic.com/firebasejs/7.14.6/firebase-performance.js"></script>

</head>
<body>
    <div class="form">
        <form id="myForm">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" >
            
            <label for="email">Email:</label>
            <input type="email" id="email" name="email">

            <label for="number">Number:</label>
            <input  id="number" name="number">
            
            <button type="button" id="addDataButton">Submit</button>
        </form>
    </div>
    

    <table id="table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Number</th>
          </tr>
        </thead>
        <tbody id="data" class="datatable" >         
        </tbody>
      </table> 
      <script type="module" src="./script.js">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/7.14.6/firebase-app.js';
  import { getPerformance } from 'https://www.gstatic.com/firebasejs/7.14.6/firebase-performance.js';
  (function(sa, fbc) {
  function load(f, c) {
    var a = document.createElement('script');
    a.async = 1;
    a.src = f;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(a, s);
  }
  load(sa);
  window.addEventListener('load', function() {
    firebase.initializeApp(fbc).performance()
  });
})(performance_standalone, firebaseConfig);

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
    apiKey: "AIzaSyBr_4N-kDvEUD6H6_czJpV3_WQERYOwXwE",
    authDomain: "notification-a1dc8.firebaseapp.com",
    databaseURL: "https://notification-a1dc8-default-rtdb.firebaseio.com",
    projectId: "notification-a1dc8",
    storageBucket: "notification-a1dc8.appspot.com",
    messagingSenderId: "950550976003",
    appId: "1:950550976003:web:e4194b60c44f96ef29e036",
    measurementId: "G-VFX2C1VEN4"
};

// Initialize Firebase
const app = firebase.initializeApp(firebaseConfig);
const firestore = app.firestore()
// Initialize Performance Monitoring and get a reference to the service
const perf = getPerformance(app);
const customTrace = perf.trace('custom_trace_name');
let html = ``;
fetchUsers();

async function fetchUsers() {
    try {
      customTrace.start();
        const querySnapshot = await firestore.collection('users').get();

        querySnapshot.forEach((doc) => {
            const data = doc.data();
            html +=
                `<tr>
                            <td>${data.name}</td>
                            <td>${data.email}</td>
                            <td>${data.number}</td>

                        </tr>`;
        });

        document.getElementById('data').innerHTML = html;
    } catch (error) {
        console.error('Error getting documents: ', error);
    }
    console.log("ppppppppppppppppppppppppppp");
    customTrace.stop();
}

async function addUserData(data) {
    try {
        // Get a reference to the 'users' collection
        const collectionRef = firestore.collection('users');

        // Add the provided data to the collection
        const docRef = await collectionRef.add(data);
        html = ``
        fetchUsers();

        console.log('Document added with ID:', docRef.id);
    } catch (error) {
        console.error('Error adding document:', error);
    }
}
// Add an event listener to the button
document.addEventListener('DOMContentLoaded', function () {
    document.getElementById('addDataButton').addEventListener('click', () => {
        const data = {
            name: document.getElementById('name').value,
            email: document.getElementById('email').value,
            number: document.getElementById('number').value,
        };
        console.log("ppppppppppppppppppppppppppp");

        // Call the function to add the data
        addUserData(data);
    });
})
    </script>
</body>
</html>